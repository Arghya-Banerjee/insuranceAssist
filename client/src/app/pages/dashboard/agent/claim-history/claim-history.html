<!-- Claim History (Tailwind dark theme) -->
<div class="w-full max-w-[1400px] mx-auto mt-4 px-4">

  <div class="rounded-2xl bg-[#1F2937]/60 border border-white/10 shadow-xl p-6">

    <h3 class="text-xl font-semibold mb-4 text-[#F0F9FF]">Claim History</h3>

    <!-- Filters Row -->
    <div class="mb-3 flex flex-wrap items-center justify-between gap-3">

      <!-- Status Filters -->
      <div class="flex flex-wrap gap-2">
        <button
          id="created-filter-btn"
          (click)="filterByStatus('CREATED')"
          class="px-3 py-1 rounded-md text-sm font-medium border border-white/10 transition"
          [ngClass]="{
            'bg-[#2563EB] text-[#F0F9FF]': activeStatusList.includes('CREATED'),
            'text-[#F0F9FF]/70': !activeStatusList.includes('CREATED')
          }">
          Created
        </button>

        <button
          id="reviewed-filter-btn"
          (click)="filterByStatus('IN REVIEW')"
          class="px-3 py-1 rounded-md text-sm font-medium border border-white/10 transition"
          [ngClass]="{
            'bg-yellow-600 text-black': activeStatusList.includes('IN REVIEW'),
            'text-[#F0F9FF]/70': !activeStatusList.includes('IN REVIEW')
          }">
          In Review
        </button>

        <button
          id="approved-filter-btn"
          (click)="filterByStatus('APPROVED')"
          class="px-3 py-1 rounded-md text-sm font-medium border border-white/10 transition"
          [ngClass]="{
            'bg-green-600 text-black': activeStatusList.includes('APPROVED'),
            'text-[#F0F9FF]/70': !activeStatusList.includes('APPROVED')
          }">
          Approved
        </button>

        <button
          id="rejected-filter-btn"
          (click)="filterByStatus('REJECTED')"
          class="px-3 py-1 rounded-md text-sm font-medium border border-white/10 transition"
          [ngClass]="{
            'bg-red-600 text-black': activeStatusList.includes('REJECTED'),
            'text-[#F0F9FF]/70': !activeStatusList.includes('REJECTED')
          }">
          Rejected
        </button>
      </div>

      <!-- Claim Type Filters -->
      <div class="flex flex-wrap gap-2">
        <button
          id="pre-filter-btn"
          (click)="filterByType('PRE')"
          class="px-3 py-1 rounded-md text-sm font-medium border border-white/10 transition"
          [ngClass]="{
            'bg-yellow-500 text-black': activeTypeList.includes('PRE'),
            'text-[#F0F9FF]/70': !activeTypeList.includes('PRE')
          }">
          PRE
        </button>

        <button
          id="post-filter-btn"
          (click)="filterByType('POST')"
          class="px-3 py-1 rounded-md text-sm font-medium border border-white/10 transition"
          [ngClass]="{
            'bg-cyan-500 text-black': activeTypeList.includes('POST'),
            'text-[#F0F9FF]/70': !activeTypeList.includes('POST')
          }">
          POST
        </button>
      </div>

      <!-- Date Range Filter -->
      <div class="flex items-center gap-2">
        <label class="text-[#F0F9FF]/80 text-sm font-medium">From:</label>
        <input
          id="start-date"
          type="date"
          [(ngModel)]="filterStartDate"
          (change)="applyFilters()"
          [attr.max]="today"
          class="rounded-md bg-[#0F172A] border border-white/10 text-[#F0F9FF] px-2 py-1 text-sm" />

        <label class="text-[#F0F9FF]/80 text-sm font-medium">To:</label>
        <input
          id="end-date"
          type="date"
          [(ngModel)]="filterEndDate"
          (change)="applyFilters()"
          [attr.max]="today"
          [attr.min]="filterStartDate"
          [disabled]="!filterStartDate"
          class="rounded-md bg-[#0F172A] border border-white/10 text-[#F0F9FF] px-2 py-1 text-sm" />
      </div>

      <!-- Clear Filters -->
      <div>
        <button
          id="clear-filter-btn"
          (click)="resetFilters()"
          title="Clear Filters"
          class="text-red-400 hover:text-red-300 text-xl font-bold">
          ✖
        </button>
      </div>
    </div>

    <!-- Search Bar -->
    <div class="mb-4">
      <input
        id="search-filter"
        type="text"
        [(ngModel)]="filterSearchTerm"
        (input)="applyFilters()"
        placeholder="Search claims..."
        class="w-full rounded-lg bg-[#0F172A] border border-white/10 text-[#F0F9FF] py-2 px-3 focus:outline-none focus:ring-2 focus:ring-[#2563EB]/40" />
    </div>

    <!-- Table / Results -->
    @if (!result) {
      <div class="rounded-lg bg-[#0b1722]/20 border border-white/6 text-[#F0F9FF]/70 p-3">
        No claims loaded yet.
      </div>
    }
    @else {
      <div class="overflow-x-auto rounded-xl border border-white/10">
        <table id="claim-history-table" class="min-w-full text-left text-sm text-[#F0F9FF]/90">

          <!-- Header -->
          <thead id="claim-history-table-header" class="bg-[#111827] text-[#F0F9FF]">
            <tr>
              <th class="p-3">Open Date</th>
              <th class="p-3">Procedure Notes</th>
              <th class="p-3 text-center">Claim Type</th>
              <th class="p-3 text-center">Status</th>
              <th class="p-3">Claim Amount</th>
            </tr>
          </thead>

          <!-- Body -->
          <tbody id="claim-history-table-body" class="divide-y divide-white/10">

            @if (result.length === 0) {
              <tr>
                <td colspan="5" class="text-center py-4 text-[#F0F9FF]/50">
                  No claims found
                </td>
              </tr>
            }

            @for (claim of result; track $index) {
              <tr class="hover:bg-[#2563EB]/10 transition">

                <td class="p-3 align-top">
                  {{ claim.openDate | date:'dd MMMM yyyy' }}
                </td>

                <td class="p-3 align-top">
                  {{ claim.procedureNotes }}
                </td>

                <td class="p-3 text-center align-top">
                  <span
                    class="inline-block px-3 py-1 rounded-md text-xs font-semibold"
                    [ngClass]="{
                      'bg-yellow-600 text-black': claim.claimType === 'PRE',
                      'bg-cyan-500 text-black': claim.claimType === 'POST'
                    }">
                    {{ claim.claimType }}
                  </span>
                </td>

                <td class="p-3 text-center align-top">
                  <span
                    class="inline-block px-3 py-1 rounded-md text-xs font-semibold"
                    [ngClass]="{
                      'bg-green-600 text-black': claim.status === 'APPROVED',
                      'bg-blue-600 text-white': claim.status === 'CREATED',
                      'bg-red-600 text-black': claim.status === 'REJECTED',
                      'bg-yellow-500 text-black': claim.status === 'IN REVIEW'
                    }">
                    {{ claim.status }}
                  </span>
                </td>

                <td class="p-3 align-top">
                  ₹{{ claim.claimAmount }}
                </td>

              </tr>
            }
          </tbody>
        </table>
      </div>
    }
  </div>
</div>
